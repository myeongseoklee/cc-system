# 충돌 해결 가이드

적응형 머지 시 발생하는 충돌 유형과 해결 방법.

## 충돌 유형

### Type 1: 섹션 충돌

양쪽에서 동일 섹션이 다르게 수정됨.

```markdown
# cc-system
## 워크플로우
1. 분석
2. 설계
3. 구현
4. 검증  ← 새로 추가

# 프로젝트
## 워크플로우
1. 분석
2. 설계 (상세)  ← 수정됨
3. 구현
```

**해결**: 양쪽 변경 모두 반영

```markdown
## 워크플로우
1. 분석
2. 설계 (상세)  ← 프로젝트 수정 보존
3. 구현
4. 검증  ← cc-system 추가 반영
```

---

### Type 2: 구조 충돌

섹션 순서나 계층이 다름.

```markdown
# cc-system
## Phase 1
## Phase 2
## Phase 3

# 프로젝트
## 준비 단계 (=Phase 1)
## 실행 단계 (=Phase 2 + 3)
```

**해결**: 프로젝트 구조 유지, 내용만 업데이트

---

### Type 3: 삭제 충돌

cc-system에서 삭제된 내용이 프로젝트에서 사용 중.

```markdown
# cc-system
(섹션 삭제됨)

# 프로젝트
## 레거시 지원  ← 여전히 필요
```

**해결**: 프로젝트에서 필요하면 보존, 경고 출력

---

### Type 4: 이름 충돌

동일 역할의 파일이 다른 이름.

```
cc-system: tdd-new-feature/
프로젝트: tdd-development/
```

**해결**: 프로젝트 이름 유지, 내용 머지

---

## 해결 우선순위

### 기본 원칙: 프로젝트 우선

| 항목 | 우선순위 |
|------|----------|
| 프로젝트 고유 설정 | 프로젝트 |
| 프로젝트 전용 섹션 | 프로젝트 |
| 워크플로우 순서 | 프로젝트 |
| 네이밍 컨벤션 | 프로젝트 |

### 예외: 템플릿 우선

| 항목 | 우선순위 |
|------|----------|
| 보안 관련 가이드 | cc-system |
| 필수 검증 단계 | cc-system |
| 버그 수정 | cc-system |
| 새로운 필수 기능 | cc-system |

---

## 수동 개입 필요 케이스

### 1. 핵심 로직 변경

```
cc-system에서 핵심 워크플로우가 크게 변경됨
+ 프로젝트에서 해당 부분을 커스터마이징함

→ 수동 검토 필요
```

**출력 예시:**

```
⚠️ 수동 확인 필요: .claude/skills/tdd/SKILL.md

cc-system 변경:
  - "Phase 2: 테스트 작성" 섹션이 완전히 재작성됨

프로젝트 상태:
  - 해당 섹션에 프로젝트 전용 예제 포함

권장 액션:
  1. 두 버전 비교 검토
  2. 프로젝트 예제를 새 구조에 맞게 조정
  3. 또는 프로젝트 버전 유지 결정
```

### 2. 의존성 변경

```
cc-system에서 참조하는 파일이 변경/삭제됨
+ 프로젝트에서 해당 참조 사용 중

→ 수동 검토 필요
```

### 3. 브레이킹 체인지

```
cc-system에서 인터페이스/구조가 변경됨
+ 프로젝트에서 기존 인터페이스 사용 중

→ 수동 마이그레이션 필요
```

---

## 충돌 마커

자동 해결이 불가능한 경우 충돌 마커 삽입:

```markdown
<<<<<<< PROJECT
## 프로젝트 버전
프로젝트 고유 내용
=======
## cc-system 버전
새로운 템플릿 내용
>>>>>>> CC-SYSTEM

수동으로 위 충돌을 해결하세요.
```

---

## 충돌 예방

### 1. PROJECT-SPECIFIC 마킹

```markdown
<!-- PROJECT-SPECIFIC -->
## 프로젝트 전용 섹션
이 내용은 동기화 시 절대 수정되지 않습니다.
<!-- /PROJECT-SPECIFIC -->
```

### 2. NO-MERGE 파일

```markdown
<!-- NO-MERGE -->
이 파일은 동기화 대상에서 제외됩니다.
```

### 3. 정기적 동기화

작은 변경을 자주 동기화하면 대규모 충돌 예방.

---

## 충돌 해결 워크플로우

```
1. 충돌 감지
   ↓
2. 유형 분류
   ↓
3. 자동 해결 가능?
   ├─ Yes → 자동 머지 + 로그
   └─ No → 충돌 마커 삽입 + 경고
   ↓
4. 결과 보고
   ↓
5. 수동 검토 (필요시)
```
